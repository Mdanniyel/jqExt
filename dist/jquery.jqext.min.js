/*
* jqExt - jQuery framework extensions
*
* Version: 0.0.1a
* Copyright 2011 Alex Tkachev
*
* Dual licensed under MIT or GPLv2 licenses
*   http://en.wikipedia.org/wiki/MIT_License
*   http://en.wikipedia.org/wiki/GNU_General_Public_License
*
* Date: Wed Jun 29 20:18:43 2011 +0300
*/
(function(a){a.ext={$break:{}},a.ext.mixins={},a.ext.extender={addWrapedSetMethods:function(a,b){for(var c in a)b&&jQuery.fn[c]&&(jQuery.fn["jq_original_"+c]=jQuery.fn[c]),jQuery.fn[c]=a[c]},addUtilityMethods:function(a){for(var b in a)jQuery[b]=a[b]}}})(jQuery),jQuery.ext.extender.addUtilityMethods({isBoolean:function(a){return jQuery.type(a)==="boolean"},isNumber:function(a){return jQuery.type(a)==="number"},isDate:function(a){return jQuery.type(a)==="date"},isString:function(a){return jQuery.type(a)==="string"},isUndefined:function(a){return jQuery.type(a)==="undefined"}},!0),function(a){a.extend(Function,{emptyFn:function(){},identityFn:function(a){return a}}),a.extend(Function.prototype,{bind:function(b){if(arguments.length<2&&a.isUndefined(arguments[0]))return this;var c=this,d=null;arguments.length>1&&(d=Array.prototype.slice.call(arguments,1));return function(){var a=arguments;if(d){a=d;if(arguments.length>0){var e=a.length,f=arguments.length;while(f--)a[e+f]=arguments[f]}}return c.apply(b,a)}}})}(jQuery),jQuery.extend(Date.prototype,{getElapsed:function(a){return Math.abs((a||new Date).getTime()-this.getTime())}}),jQuery.extend(String.prototype,{format:function(){var a=this;for(var b=0;b<arguments.length;b++){var c=new RegExp("\\{"+b+"\\}","gm");a=a.replace(c,arguments[b])}return a},startsWith:function(a){return this.lastIndexOf(a,0)===0},include:function(a){return this.indexOf(a)!=-1},endsWith:function(a){var b=this.length-a.length;return b>=0&&this.indexOf(a,b)===b},trim:function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")}}),jQuery.extend(RegExp,{escape:function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}}),jQuery.Event.Keys={BACKSPACE:8,TAB:9,RETURN:13,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,HOME:36,END:35,PAGE_UP:33,PAGE_DOWN:34,INSERT:45},jQuery.extend(jQuery.Event.prototype,{stopEvent:function(){this.preventDefault(),this.stopPropagation()},isSpecialKey:function(){var a=this.which;return this.ctrlKey||this.isNavKeyPress()||a==jQuery.Event.Keys.BACKSPACE||a>=16&&a<=20||a>=44&&a<=46},isNavKeyPress:function(){var a=this.which;return a>=33&&a<=40||a==jQuery.Event.Keys.RETURN||a==jQuery.Event.Keys.TAB||a==jQuery.Event.Keys.ESC},isBackspaceKey:function(){return this.which==jQuery.Event.Keys.BACKSPACE},isDeleteKey:function(){return this.which==jQuery.Event.Keys.DELETE},isTabKey:function(){return this.which==jQuery.Event.Keys.TAB},isEnterKey:function(){return this.which==jQuery.Event.Keys.RETURN},isEscKey:function(){return this.which==jQuery.Event.Keys.ESC},isUpKey:function(){return this.which==jQuery.Event.Keys.UP},isDownKey:function(){return this.which==jQuery.Event.Keys.DOWN}}),jQuery.ext.extender.addUtilityMethods({systemInfo:function(){var a=navigator.userAgent.toLowerCase(),b=function(b){return b.test(a)},c={browser:{},os:{}};c.browser.isStrict=document.compatMode=="CSS1Compat",c.browser.isSecure=/^https/i.test(window.location.protocol),c.browser.isOpera=b(/opera/),c.browser.isChrome=b(/\bchrome\b/),c.browser.isWebKit=b(/webkit/),c.browser.isSafari=!c.browser.isChrome&&b(/safari/),c.browser.isSafari2=c.browser.isSafari&&b(/applewebkit\/4/),c.browser.isSafari3=c.browser.isSafari&&b(/version\/3/),c.browser.isSafari4=c.browser.isSafari&&b(/version\/4/),c.browser.isIE=!c.browser.isOpera&&b(/msie/),c.browser.isIE7=c.browser.isIE&&b(/msie 7/),c.browser.isIE8=c.browser.isIE&&b(/msie 8/),c.browser.isIE6=c.browser.isIE&&!c.browser.isIE7&&!c.browser.isIE8,c.browser.isGecko=!c.browser.isWebKit&&b(/gecko/),c.browser.isGecko2=c.browser.isGecko&&b(/rv:1\.8/),c.browser.isGecko3=c.browser.isGecko&&b(/rv:1\.9/),c.browser.isBorderBox=c.browser.isIE&&!c.browser.isStrict,c.os.isWindows=b(/windows|win32/),c.os.isMac=b(/macintosh|mac os x/),c.os.isAir=b(/adobeair/),c.os.isLinux=b(/linux/);return c}()},!0),function(a){var b={__initListeners:function(a){this.__listeners=this.__listeners||{},this.__listeners[a]=this.__listeners[a]||[]},addListener:function(b,c,d,e){if(a.type(b)==="string"&&b.length>0)if(b.indexOf(" ")==-1){c=c||null;var f={fn:c,scope:d||this,args:e||null};this.hasListener(b,f.fn,f.scope,f.args)||(this.__initListeners(b),this.__listeners[b].push(f))}else{var g=b.split(" ");for(var h=0;h<g.length;h++)this.addListener.call(this,g[h],c,d,e)}else{var i=b;for(var j in i)if(j!="scope"&&j!="args"){var k=i[j];this.addListener(j,k.fn||k,k.scope||i.scope,{args:k.args||i.args})}}return this},removeListener:function(b,c,d){if(a.type(b)==="string"&&b.length>0)if(b.indexOf(" ")==-1){this.__initListeners(b);if(arguments.length==1)this.__listeners[b].clear();else{d=d||{};var e=this.findListener(b,c,d.scope||this,d.args||null);e!==null&&this.__listeners[b].remove(e)}}else{var f=b.split(" ");for(var g=0;g<f.length;g++)this.removeListener.call(this,f[g],c,d)}else{var h=b;for(var i in h)if(i!="scope"&&i!="args"){var j=h[i];this.removeListener(i,j.fn||j,j.scope||h.scope,{args:j.args||h.args})}}return this},hasListener:function(a,b,c,d){return this.findListener(a,b,c,d)!==null},findListener:function(a,b,c,d){this.__initListeners(a);var e=this.__listeners[a];for(var f=0;f<e.length;f++){var g=e[f];if(g.fn==b&&g.scope==c&&g.args==d)return g}return null},fireListener:function(b){this.__initListeners(b);var c=[],d=a.makeArray(arguments).slice(1),e={eventName:b,source:this,bindArgs:null};d.unshift(e);for(var f=0;f<this.__listeners[b].length;++f){var g=this.__listeners[b][f];e.bindArgs=g.args;var h=g.fn.apply(g.scope,d)||null;if(h==a.ext.$break)return!1;c.push(h)}return c}};b.fire=b.fireListener,b.on=b.addListener,b.un=b.removeListener,a.ext.mixins.Observable=b}(jQuery)